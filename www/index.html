<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <script type="text/javascript" charset="utf-8" src="cordova.js"></script>
        <link rel="stylesheet" type="text/css" href="css/jquery.mobile-1.3.2.min.css"/>
        <script type="text/javascript" charset="utf-8" src="js/vendor/jquery-1.10.2.js"></script>
        <script type="text/javascript" charset="utf-8" src="js/index.js"></script>
        <script type="text/javascript" charset="utf-8" src="js/vendor/LAB.min.js"></script>
        <script type="text/javascript">
        $LAB
        .wait(function () {
            $(document).on('pageinit', '#page-home',  function(){
                // alert("pageinit");
                $("#jquery-output").html("Pageinit event");
            });
        })
        .wait(function (){
            // IMPORTANT: This must execute before jQueryMobile is loaded!
            $(document).bind("mobileinit", function() {
                // alert("mobileinit","info");
                // Placeholder for framework settings overrides
                $.mobile.allowCrossDomainPages = true;
                $.support.cors = true;
            });
        })
        .script("js/vendor/jquery.mobile-1.3.2.min.js")
        .wait(function () {
            // When ALL scripts have been loaded AND executed: 
            
            $(function() {
                setTimeout(hideSplash, 2000);
            });
            
            $(document).on("pagebeforechange", function(e,ob) {
                console.log($.mobile.urlHistory.stack);
            //     if(ob.toPage && ob.toPage[0].id === "splash") {
            //         if(!e.isPropagationStopped()){
            //             console.log(e);
            //             e.stopPropagation();
            //             e.preventDefault();
            //         }
            //         //O back to splash fica pendurado aqui e quando carrego a pr√≥xima vez ele quer voltar para o splash
            //     }
            });
            function hideSplash() {
                $.mobile.changePage("#page-home", "fade");
                $.mobile.urlHistory.stack[0].hash = $.mobile.urlHistory.stack[1].hash
                $.mobile.urlHistory.stack[0].pageUrl = $.mobile.urlHistory.stack[1].pageUrl
                $.mobile.urlHistory.stack[0].url = $.mobile.urlHistory.stack[1].url
                // $.mobile.urlHistory.stack.pop();
                // $.mobile.urlHistory.stack = $.mobile.urlHistory.stack.slice(1, 2);
                // $.mobile.urlHistory.activeIndex = $.mobile.urlHistory.activeIndex-1;
                // console.log($.mobile.urlHistory.stack.slice(1, 2));
                // console.log($.mobile.urlHistory.stack.slice(1, 2));
                // $.mobile.urlHistory.stack = $.mobile.urlHistory.stack.slice(1, 2);
            }                
        });
        </script>
        <title>Hello World</title>
        
        <script type="text/javascript" charset="utf-8">
            // Espera o Cordova Carregar        
            document.addEventListener("deviceready", onDeviceReady, false);
            function onDeviceReady() {
                $("#cordova-output").html("Hello, World! Cordova Device ir Ready!");
            }
        </script>
        
    </head>
    <body> <!-- ponderar usar o onload event -->
        <div data-role="page" data-theme="b" id="splash" style="background-color: #green;"> 
            <div class="splash">
                <img src="http://jquerymobile.com/demos/1.0a4.1/docs/_assets/images/jquery-logo.png" alt="splash" />
            </div>
        </div>
        <div data-role="page" id="page-home">
            <div data-role="header" data-id="header" data-position="fixed">
                <h3>Cordova Demo</h1>
            </div>
            <div id="content" data-role="content">
                <div id="cordova-output"></div>
                <div id="jquery-output"></div>
                <a href="#page-2" data-role="button" data-transition="slide" data-inline="true" data-corners="true" data-shadow="true" data-iconshadow="true">Page 2</a>
            </div>
            <div data-role="footer" data-id="footer" data-position="fixed">
                <div data-role="navbar">
                     <ul>
                     <li><a href="#page-home" >Page 1</a></li>
                     <li><a href="#page-2" data-role="button" data-transition="slide" data-inline="true">Page 2</a></li>
                     <li><a href="#page-3" >Page 3</a></li>
                     </ul>
                </div><!-- /navbar -->
            </div>
        </div>

        <div data-role="page" id="page-2">
            <div data-role="header" data-id="header" data-position="fixed">
                <h3>Cordova Demo</h1>
            </div>
            <div id="content" data-role="content">
                Im the page number 2
                <a href="#" 
                    data-role="button" 
                    data-transition="slide" 
                    data-inline="true" 
                    data-corners="true" 
                    data-shadow="true" 
                    data-iconshadow="true" 
                    data-wrapperels="" 
                    data-rel="back" 
                    data-direction="reverse" 
                    data-theme="a" 
                    class="ui-btn ui-shadow ui-btn-corner-all ui-btn-inline ui-btn-up-a">Back</a>

                    <a href="#page-3" data-role="button" data-transition="slide" data-inline="true" data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="" data-theme="a" class="ui-btn ui-shadow ui-btn-corner-all ui-btn-inline ui-btn-up-a">Page 3</a>
            </div>
            <div data-role="footer" data-id="footer" data-position="fixed">
                <div data-role="navbar">
                     <ul>
                     <li><a href="#page-home" >Page 1</a></li>
                     <li><a href="#page-2" data-role="button" data-transition="slide" data-inline="true">Page 2</a></li>
                     <li><a href="#page-3" >Page 3</a></li>
                     </ul>
                </div><!-- /navbar -->
            </div>
        </div>

        <div data-role="page" id="page-3">
            <div data-role="header" data-id="header" data-position="fixed">
                <h3>Cordova Demo</h1>
            </div>
            <div id="content" data-role="content">
                Im the page number 3
                <a href="#" data-role="button" data-rel="back" data-transition="slide" data-inline="true" data-corners="true" data-shadow="true" data-iconshadow="true" data-wrapperels="" data-rel="back" >Back</a>
            </div>
            <div data-role="footer" data-id="footer" data-position="fixed">
                <div data-role="navbar">
                     <ul>
                     <li><a href="#page-home" >Page 1</a></li>
                     <li><a href="#page-2" data-role="button" data-transition="slide" data-inline="true">Page 2</a></li>
                     <li><a href="#page-3" >Page 3</a></li>
                     </ul>
                </div><!-- /navbar -->
            </div>
        </div>
    </body>
</html>
